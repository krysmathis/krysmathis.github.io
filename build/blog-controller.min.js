/*! krysmathis.github.io 2017-11-02 */

let currentBlogs=[],itemsPerPage=5;const getBlogs=function(e){const t=((JSON.parse(localStorage.getItem("blog"))||{}).blogEntries||[]).sort((e,t)=>moment(t.dateAdded)-moment(e.dateAdded));let n=[];return n=void 0===e||""===e?t:t.filter(t=>t.headline.toLowerCase().includes(e)||t.content.toLowerCase().includes(e)),currentBlogs=n,n},getBlogsMatchedTags=function(e){const t=[];return getBlogs("").forEach(n=>{n.tags.forEach(a=>{a===e&&t.push(n)})}),t},filterByTag=e=>{currentBlogs=getBlogsMatchedTags(e.target.innerHTML),console.log("currentBlgos",currentBlogs),writeBlogsEl(1),setInitialPagination()},setInitialPagination=function(){const e=currentBlogs.length,t=Math.ceil(e/itemsPerPage);setPaginationByEls(t,1),document.querySelector(".pagination").style.visibility=t>1?"":"hidden"},writeBlogsEl=function(e){const t=currentBlogs,n=document.getElementById("blog-posts");for(;n.hasChildNodes();)n.removeChild(n.lastChild);t.length<1?n.innerHTML="No blogs found...":t.slice((e-1)*itemsPerPage,e*itemsPerPage).forEach(function(e){let t=e.imgHeader.startsWith("images")?"../"+e.imgHeader:e.imgHeader,a=document.createElement("article");a.className="blog__post";let l=document.createElement("div");l.className="blog__header";let o=document.createElement("div");o.className="blog__headline";let i=document.createTextNode(e.headline);o.appendChild(i);let d=document.createElement("div");d.className="blog__date";let c=document.createTextNode(moment(e.dateAdded).format("YYYY-MM-DD"));d.appendChild(c),l.appendChild(o),l.appendChild(d),a.appendChild(l);let r=document.createElement("div");r.className="blog__img-header";let s=document.createElement("img");s.src=t,r.appendChild(s),a.appendChild(r);let g=document.createElement("div");g.className="blog__content",g.innerHTML=e.content,a.appendChild(g);let m=document.createElement("div");m.className="blog__footer project-tag";let u=document.createElement("ul");e.tags.forEach(e=>{let t=document.createElement("li");t.className="blog__tag",t.appendChild(document.createTextNode(e)),u.appendChild(t),t.addEventListener("click",filterByTag)}),m.appendChild(u),a.appendChild(m),n.appendChild(a)})};document.querySelector(".pagination").addEventListener("click",function(e){if(!isValidPagination(e))return;const t=e.target.dataset.pageNum;writeBlogsEl(t),updatePagination(e)}),getBlogs(""),writeBlogsEl(1),setInitialPagination();